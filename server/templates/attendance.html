{% extends "_base.html" %}

{% block content %}
<h3 class="mb-4">
  <i class="bi bi-journal-text me-2"></i>
  Lịch sử chấm công
</h3>

<div class="card shadow-sm">

  <div class="card-header d-flex justify-content-between align-items-center">
    <span class="fw-semibold">Danh sách log chấm công</span>

    {% if session.get('role') == 'admin' %}
      <a href="{{ url_for('web_ui.export_data') }}" class="btn btn-sm btn-success">
        <i class="bi bi-file-earmark-arrow-down me-1"></i>
        Xuất file
      </a>
    {% endif %}
  </div>

  <div class="card-body p-0">
    <table class="table table-hover align-middle mb-0">
      <thead class="table-dark">
        <tr>
          <th style="width: 80px;">ID</th>
          <th>User</th>
          <th>Phòng ban</th>
          <th>Chức vụ</th>
          <th style="width: 120px;">Action</th>
          <th style="width: 220px;">Time</th>
        </tr>
      </thead>
      <tbody>
        {% for r in logs %}
        <tr>
          <td>{{ r.id }}</td>
          <td>{{ r.user.full_name or r.user.username }}</td>
          <td>
            {{ r.user.department or "—" }}
          </td>

          <td>
            {{ r.user.position or "—" }}
          </td>
          <td>
            {% if r.action == 'checkin' %}
              <span class="badge bg-success">Check-in</span>
            {% else %}
              <span class="badge bg-danger">Check-out</span>
            {% endif %}
          </td>
          <td>{{ r.timestamp.strftime("%H:%M:%S %d-%m-%Y") }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="4" class="text-center text-muted py-4">
            Chưa có dữ liệu chấm công
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
