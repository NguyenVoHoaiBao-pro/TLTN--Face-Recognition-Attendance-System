{% extends "_base.html" %}
{% block content %}
<h3 class="mb-3"><i class="bi bi-camera me-2"></i>Đăng ký / Upload khuôn mặt</h3>
<div class="card shadow-sm p-4">
  <form id="f" enctype="multipart/form-data">
    <div class="mb-3">
      <label class="form-label">Chọn ảnh khuôn mặt (jpg/png)</label>
      <input class="form-control" type="file" name="file" accept="image/*" required>
    </div>
    {% if session.get('role') == 'admin' %}
    <div class="mb-3">
      <label class="form-label">User ID (tùy chọn – nếu trống sẽ là chính bạn)</label>
      <input class="form-control" name="user_id" placeholder="VD: 5">
    </div>
    {% endif %}
    <button class="btn btn-primary"><i class="bi bi-upload"></i> Upload</button>
  </form>
</div>

<script>
const form = document.getElementById('f');
form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const fd = new FormData(form);
  const res = await fetch('/api/upload_face', { method:'POST', body: fd });
  if(res.ok){
    alert('Tải ảnh thành công');
  }else{
    const t = await res.text();
    alert('Lỗi: ' + t);
  }
});
</script>
{% endblock %}
